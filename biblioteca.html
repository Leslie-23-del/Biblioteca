<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Biblioteca ClÃ¡sica</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600&family=Libre+Baskerville&display=swap" rel="stylesheet">
<script src="https://unpkg.com/epubjs/dist/epub.min.js"></script>

<style>
body {
  margin:0;
  font-family:'Libre Baskerville', serif;
  background:#2b1d12;
  color:#f5f1ea;
}

header {
  background:#3a2616;
  padding:1.5rem;
  text-align:center;
  border-bottom:4px solid #c9a35d;
}

main {
  padding:2rem;
  max-width:1200px;
  margin:auto;
}

.libros {
  display:flex;
  gap:12px;
  background:#2a1b10;
  padding:1rem;
  border-radius:12px;
  overflow-x:auto;
}

.libro {
  writing-mode:vertical-rl;
  background:linear-gradient(180deg,#7b4a1f,#4a2c12);
  color:#f1e4c3;
  padding:1rem .5rem;
  height:180px;
  width:40px;
  cursor:pointer;
  transition:transform .4s;
}

.libro:hover {
  transform:translateY(-15px) rotate(-2deg);
}

footer {
  text-align:center;
  padding:1rem;
  background:#1a120b;
  font-size:.85rem;
}

/* MODO NOCHE */
.modo-noche {
  background:#000 !important;
  color:#eee !important;
}

/* RESPONSIVE */
@media (max-width:600px){
  .libro { height:140px; width:32px; }
}
</style>

<script>
let libroActual=null;
let vista=null;
let libroID=null;

// MAPA DE LIBROS â†’ EPUB
const biblioteca = {
  romance1: "epubs/romance1.epub",
  romance2: "epubs/romance2.epub",
  fantasia1: "epubs/fantasia1.epub",
  terror1: "epubs/terror1.epub"
};

function abrirLibro(id){
  libroID=id;
  document.getElementById("modal").style.display="flex";

  libroActual=ePub(biblioteca[id]);
  vista=libroActual.renderTo("lector",{width:"100%",height:"70vh"});

  libroActual.ready.then(()=>{
    const progreso=localStorage.getItem("progreso_"+id);
    vista.display(progreso || undefined);
  });

  vista.on("relocated",loc=>{
    localStorage.setItem("progreso_"+id,loc.start.cfi);
  });
}

function cerrarLector(){
  document.getElementById("modal").style.display="none";
  if(libroActual){ libroActual.destroy(); }
}

function siguiente(){ if(vista) vista.next(); }
function anterior(){ if(vista) vista.prev(); }

// ðŸŒ™ MODO NOCHE AUTOMÃTICO
window.onload=()=>{
  const hora=new Date().getHours();
  if(hora>=18 || hora<=6){
    document.body.classList.add("modo-noche");
  }
};
</script>
</head>

<body>

<header>
  <h1>Biblioteca ClÃ¡sica</h1>
  <p>Conocimiento preservado en el tiempo</p>
</header>

<main>

<h2>Romance</h2>
<div class="libros">
  <div class="libro" onclick="abrirLibro('romance1')">Romance oscuro</div>
  <div class="libro" onclick="abrirLibro('romance2')">Deseo prohibido</div>
</div>

<h2>FantasÃ­a</h2>
<div class="libros">
  <div class="libro" onclick="abrirLibro('fantasia1')">Reinos</div>
</div>

<h2>Terror</h2>
<div class="libros">
  <div class="libro" onclick="abrirLibro('terror1')">Sobrenatural</div>
</div>

</main>

<footer>
Â© 2026 Biblioteca ClÃ¡sica Â· Proyecto personal
</footer>

<!-- MODAL -->
<div id="modal" style="
display:none;
position:fixed;
inset:0;
background:rgba(0,0,0,.85);
justify-content:center;
align-items:center;
z-index:999;
">
  <div style="
    background:#fff;
    width:90%;
    max-width:900px;
    padding:1rem;
    border-radius:12px;
    color:#000;
  ">
    <button onclick="cerrarLector()">Cerrar</button>
    <button onclick="anterior()">â—€</button>
    <button onclick="siguiente()">â–¶</button>

    <div id="lector" style="margin-top:1rem;height:70vh;overflow:hidden;"></div>
  </div>
</div>

</body>
</html>
